<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.basic.oaas.dao.OrgMapper">
  <resultMap id="BaseResultMap" type="com.basic.oaas.model.Org">
    <id column="ORG_ID" jdbcType="DECIMAL" property="orgId" />
    <result column="ORG_CODE" jdbcType="VARCHAR" property="orgCode" />
    <result column="ORG_NAME" jdbcType="VARCHAR" property="orgName" />
    <result column="PARENT_ORG_ID" jdbcType="DECIMAL" property="parentOrgId" />
    <result column="AREA_ID" jdbcType="DECIMAL" property="areaId" />
    <result column="DISPLAY_INDEX" jdbcType="DECIMAL" property="displayIndex" />
    <result column="ID_PATH" jdbcType="VARCHAR" property="idPath" />
    <result column="NAME_PATH" jdbcType="VARCHAR" property="namePath" />
    <result column="CODE_PATH" jdbcType="VARCHAR" property="codePath" />
    <result column="STATE" jdbcType="VARCHAR" property="state" />
    <result column="CREATE_USER_ID" jdbcType="DECIMAL" property="createUserId" />
    <result column="CREATE_TIME" jdbcType="TIMESTAMP" property="createTime" />
    <result column="MODIFY_USER_ID" jdbcType="DECIMAL" property="modifyUserId" />
    <result column="MODIFY_TIME" jdbcType="TIMESTAMP" property="modifyTime" />
    <result column="REMARKS" jdbcType="VARCHAR" property="remarks" />
    <result column="ORG_TYPE" jdbcType="VARCHAR" property="orgType" />
    
    <result column="ID" property="id" jdbcType="DECIMAL" />
	<result column="NAME" property="name" jdbcType="VARCHAR" />
	
	<result column="CREATEUSERNAME" property="createUserName" jdbcType="VARCHAR" />
	<result column="MODIFYUSERNAME" property="modifyUserName" jdbcType="VARCHAR" />
	
	<result column="AREA_NAME" property="areaName" jdbcType="VARCHAR" />
	
	<result column="ORG_ENG_NAME" property="orgEngName" jdbcType="VARCHAR" />
	<result column="ORG_ABS_NAME" property="orgAbsName" jdbcType="VARCHAR" />
	<result column="ORG_ADMIN" property="orgAdmin" jdbcType="NUMERIC" />
	<result column="OPEN_STATUS" property="openStatus" jdbcType="NUMERIC" />
	<result column="OPEN_DATE" property="openDate" jdbcType="TIMESTAMP" />
	<result column="STOP_DATE" property="stopDate" jdbcType="TIMESTAMP" />
	<result column="SOURCE" property="source" jdbcType="NUMERIC" />
	<result column="SYNC_DATE" property="syncDate" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Base_Column_List">
    ORG_ID, ORG_CODE, ORG_NAME, PARENT_ORG_ID, AREA_ID, DISPLAY_INDEX, ID_PATH, NAME_PATH, 
    CODE_PATH, STATE, CREATE_USER_ID, CREATE_TIME, MODIFY_USER_ID, MODIFY_TIME, REMARKS,ORG_TYPE,
    ORG_ENG_NAME,ORG_ABS_NAME,ORG_ADMIN,OPEN_STATUS,OPEN_DATE,STOP_DATE,SOURCE,SYNC_DATE
  </sql>
  
  <select id="selectByPrimaryKey" parameterType="java.math.BigDecimal" resultMap="BaseResultMap">
    SELECT OO.*,POO.ORG_CODE 'parentOrgCode' ,POO.ORG_ABS_NAME 'parentOrgAbsName',
    AREA.AREA_NAME 'areaName',U.USER_ID 'orgAdmin',U.USER_TEXT 'orgAdminName',STAFF.TELEPHONE 'orgAdminMobile',
    STAFF.POST 'orgAdminPost',CU.USER_TEXT 'createUserName',MU.USER_TEXT 'modifyUserName',
    COMPANY.FULL_NAME 'company'
    FROM OAAS_ORG OO
    LEFT JOIN OAAS_ORG POO ON POO.ORG_ID = OO.PARENT_ORG_ID AND POO.STATE = '10A'
    LEFT JOIN OAAS_AREA AREA ON AREA.AREA_ID = OO.AREA_ID AND AREA.STATE = '10A'
    LEFT JOIN OAAS_ORG_COMPANY OC ON OC.ORG_ID = OO.ORG_ID
    LEFT JOIN OAAS_COMPANY COMPANY ON COMPANY.COMPANY_ID = OC.COMPANY_ID  AND COMPANY.STATE = '10A'
    LEFT JOIN OAAS_USER U ON U.USER_ID = OO.ORG_ADMIN
    LEFT JOIN OAAS_USER_STAFF OUS ON OUS.USER_ID = U.USER_ID
    LEFT JOIN OAAS_STAFF STAFF ON STAFF.STAFF_ID = OUS.STAFF_ID
    LEFT JOIN OAAS_USER CU ON CU.USER_ID = OO.CREATE_USER_ID
    LEFT JOIN OAAS_USER MU ON MU.USER_ID = OO.MODIFY_USER_ID
    WHERE OO.STATE = '10A'
    AND OO.ORG_ID = #{orgId,jdbcType=DECIMAL}
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.math.BigDecimal">
    DELETE FROM OAAS_ORG
    WHERE ORG_ID = #{orgId,jdbcType=DECIMAL}
  </delete>
  
  <insert id="insert" parameterType="com.basic.oaas.model.Org">
    INSERT INTO OAAS_ORG (ORG_ID, ORG_CODE, ORG_NAME, 
      PARENT_ORG_ID, AREA_ID, DISPLAY_INDEX, 
      ID_PATH, NAME_PATH, CODE_PATH, 
      STATE, CREATE_USER_ID, CREATE_TIME, 
      MODIFY_USER_ID, MODIFY_TIME, REMARKS,ORG_TYPE,
      ORG_ENG_NAME,ORG_ABS_NAME,ORG_ADMIN,OPEN_STATUS,OPEN_DATE,STOP_DATE,SOURCE,SYNC_DATE
      )
    VALUES (#{orgId,jdbcType=DECIMAL}, #{orgCode,jdbcType=VARCHAR}, #{orgName,jdbcType=VARCHAR}, 
      #{parentOrgId,jdbcType=DECIMAL}, #{areaId,jdbcType=DECIMAL}, #{displayIndex,jdbcType=DECIMAL}, 
      #{idPath,jdbcType=VARCHAR}, #{namePath,jdbcType=VARCHAR}, #{codePath,jdbcType=VARCHAR}, 
      #{state,jdbcType=VARCHAR}, #{createUserId,jdbcType=DECIMAL}, #{createTime,jdbcType=TIMESTAMP}, 
      #{modifyUserId,jdbcType=DECIMAL}, #{modifyTime,jdbcType=TIMESTAMP}, #{remarks,jdbcType=VARCHAR},
      #{orgType,jdbcType=VARCHAR},#{orgEngName,jdbcType=VARCHAR},#{orgAbsName,jdbcType=VARCHAR},#{orgAdmin,jdbcType=NUMERIC},
      #{openStatus,jdbcType=NUMERIC},#{openDate,jdbcType=TIMESTAMP},#{stopDate,jdbcType=TIMESTAMP},
      #{source,jdbcType=NUMERIC},#{syncDate,jdbcType=TIMESTAMP}
      )
  </insert>
  
  <insert id="insertSelective" parameterType="com.basic.oaas.model.Org">
    INSERT INTO OAAS_ORG
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="orgId != null">
        ORG_ID,
      </if>
      <if test="orgCode != null">
        ORG_CODE,
      </if>
      <if test="orgName != null">
        ORG_NAME,
      </if>
      <if test="parentOrgId != null">
        PARENT_ORG_ID,
      </if>
      <if test="areaId != null">
        AREA_ID,
      </if>
      <if test="displayIndex != null">
        DISPLAY_INDEX,
      </if>
      <if test="idPath != null">
        ID_PATH,
      </if>
      <if test="namePath != null">
        NAME_PATH,
      </if>
      <if test="codePath != null">
        CODE_PATH,
      </if>
      <if test="state != null">
        STATE,
      </if>
      <if test="createUserId != null">
        CREATE_USER_ID,
      </if>
      <if test="createTime != null">
        CREATE_TIME,
      </if>
      <if test="modifyUserId != null">
        MODIFY_USER_ID,
      </if>
      <if test="modifyTime != null">
        MODIFY_TIME,
      </if>
      <if test="remarks != null">
        REMARKS,
      </if>
      <if test="orgType != null">
      	ORG_TYPE,
      </if>
      <if test="orgEngName != null">
      	ORG_ENG_NAME,
      </if>
      <if test="orgAbsName != null">
      	ORG_ABS_NAME,
      </if>
      <if test="orgAdmin != null">
      	ORG_ADMIN,
      </if>
      <if test="openStatus != null">
      	OPEN_STATUS,
      </if>
      <if test="openDate != null">
      	OPEN_DATE,
      </if>
      <if test="stopDate != null">
      	STOP_DATE,
      </if>
      <if test="source != null">
      	SOURCE,
      </if>
      <if test="syncDate != null">
      	SYNC_DATE
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="orgId != null">
        #{orgId,jdbcType=DECIMAL},
      </if>
      <if test="orgCode != null">
        #{orgCode,jdbcType=VARCHAR},
      </if>
      <if test="orgName != null">
        #{orgName,jdbcType=VARCHAR},
      </if>
      <if test="parentOrgId != null">
        #{parentOrgId,jdbcType=DECIMAL},
      </if>
      <if test="areaId != null">
        #{areaId,jdbcType=DECIMAL},
      </if>
      <if test="displayIndex != null">
        #{displayIndex,jdbcType=DECIMAL},
      </if>
      <if test="idPath != null">
        #{idPath,jdbcType=VARCHAR},
      </if>
      <if test="namePath != null">
        #{namePath,jdbcType=VARCHAR},
      </if>
      <if test="codePath != null">
        #{codePath,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="createUserId != null">
        #{createUserId,jdbcType=DECIMAL},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="modifyUserId != null">
        #{modifyUserId,jdbcType=DECIMAL},
      </if>
      <if test="modifyTime != null">
        #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="remarks != null">
        #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="orgType != null">
      	 #{orgType,jdbcType=VARCHAR},
      </if>
      <if test="orgEngName != null">
      	 #{orgEngName,jdbcType=VARCHAR},
      </if>
      <if test="orgAbsName != null">
      	 #{orgAbsName,jdbcType=VARCHAR},
      </if>
      <if test="orgAdmin != null">
      	 #{orgAdmin,jdbcType=NUMERIC},
      </if>
      <if test="openStatus != null">
      	 #{openStatus,jdbcType=NUMERIC},
      </if>
      <if test="openDate != null">
      	 #{openDate,jdbcType=TIMESTAMP},
      </if>
      <if test="stopDate != null">
      	 #{stopDate,jdbcType=TIMESTAMP},
      </if>
      <if test="source != null">
      	 #{source,jdbcType=NUMERIC},
      </if>
      <if test="syncDate != null">
      	 #{syncDate,jdbcType=TIMESTAMP}
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.basic.oaas.model.Org">
    UPDATE OAAS_ORG
    <set>
      <if test="orgCode != null">
        ORG_CODE = #{orgCode,jdbcType=VARCHAR},
      </if>
      <if test="orgName != null">
        ORG_NAME = #{orgName,jdbcType=VARCHAR},
      </if>
      <if test="parentOrgId != null">
        PARENT_ORG_ID = #{parentOrgId,jdbcType=DECIMAL},
      </if>
      <if test="areaId != null">
        AREA_ID = #{areaId,jdbcType=DECIMAL},
      </if>
      <if test="displayIndex != null">
        DISPLAY_INDEX = #{displayIndex,jdbcType=DECIMAL},
      </if>
      <if test="idPath != null">
        ID_PATH = #{idPath,jdbcType=VARCHAR},
      </if>
      <if test="namePath != null">
        NAME_PATH = #{namePath,jdbcType=VARCHAR},
      </if>
      <if test="codePath != null">
        CODE_PATH = #{codePath,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        STATE = #{state,jdbcType=VARCHAR},
      </if>
      <if test="createUserId != null">
        CREATE_USER_ID = #{createUserId,jdbcType=DECIMAL},
      </if>
      <if test="createTime != null">
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="modifyUserId != null">
        MODIFY_USER_ID = #{modifyUserId,jdbcType=DECIMAL},
      </if>
      <if test="modifyTime != null">
        MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
      </if>
      <if test="remarks != null">
        REMARKS = #{remarks,jdbcType=VARCHAR},
      </if>
      <if test="orgType != null">
      	ORG_TYPE = #{orgType,jdbcType=VARCHAR},
      </if>
      <if test="orgAbsName != null">
      	 ORG_ABS_NAME = #{orgAbsName,jdbcType=VARCHAR},
      </if>
      <if test="orgEngName != null">
      	 ORG_ENG_NAME = #{orgEngName,jdbcType=VARCHAR},
      </if>
      <if test="orgAdmin != null">
      	 ORG_ADMIN = #{orgAdmin,jdbcType=NUMERIC},
      </if>
      <if test="openStatus != null">
      	 OPEN_STATUS = #{openStatus,jdbcType=NUMERIC},
      </if>
      <if test="openDate != null">
      	 OPEN_DATE = #{openDate,jdbcType=TIMESTAMP},
      </if>
      <if test="stopDate != null">
      	 STOP_DATE = #{stopDate,jdbcType=TIMESTAMP},
      </if>
      <if test="source != null">
      	 SOURCE = #{source,jdbcType=NUMERIC},
      </if>
      <if test="syncDate != null">
      	 SYNC_DATE = #{syncDate,jdbcType=TIMESTAMP}
      </if>
    </set>
    WHERE ORG_ID = #{orgId,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.basic.oaas.model.Org">
    UPDATE OAAS_ORG
    SET ORG_CODE = #{orgCode,jdbcType=VARCHAR},
        ORG_NAME = #{orgName,jdbcType=VARCHAR},
        PARENT_ORG_ID = #{parentOrgId,jdbcType=DECIMAL},
        AREA_ID = #{areaId,jdbcType=DECIMAL},
        DISPLAY_INDEX = #{displayIndex,jdbcType=DECIMAL},
        ID_PATH = #{idPath,jdbcType=VARCHAR},
        NAME_PATH = #{namePath,jdbcType=VARCHAR},
        CODE_PATH = #{codePath,jdbcType=VARCHAR},
        STATE = #{state,jdbcType=VARCHAR},
        CREATE_USER_ID = #{createUserId,jdbcType=DECIMAL},
        CREATE_TIME = #{createTime,jdbcType=TIMESTAMP},
        MODIFY_USER_ID = #{modifyUserId,jdbcType=DECIMAL},
        MODIFY_TIME = #{modifyTime,jdbcType=TIMESTAMP},
        REMARKS = #{remarks,jdbcType=VARCHAR},
      	ORG_TYPE = #{orgType,jdbcType=VARCHAR},
      	ORG_ABS_NAME = #{orgAbsName,jdbcType=VARCHAR},
      	ORG_ENG_NAME = #{orgEngName,jdbcType=VARCHAR},
      	ORG_ADMIN = #{orgAdmin,jdbcType=NUMERIC},
      	OPEN_STATUS = #{openStatus,jdbcType=NUMERIC},
      	OPEN_DATE = #{openDate,jdbcType=TIMESTAMP},
      	STOP_DATE = #{stopDate,jdbcType=TIMESTAMP},
      	SOURCE = #{source,jdbcType=NUMERIC},
      	SYNC_DATE = #{syncDate,jdbcType=TIMESTAMP}
    WHERE ORG_ID = #{orgId,jdbcType=DECIMAL}
  </update>
  
  <!-- 获取树，可以不要，新的实现不用treebean -->
  <select id="selectByOrg" parameterType="com.basic.oaas.bean.OrgIbean"
		resultMap="BaseResultMap">
		SELECT
			OO.*,
			OU1.USER_TEXT AS CREATEUSERNAME,OU2.USER_TEXT AS MODIFYUSERNAME,
			OA.AREA_NAME
		FROM
		OAAS_ORG OO
		LEFT JOIN OAAS_USER OU1 ON OU1.USER_ID = OO.CREATE_USER_ID
		LEFT JOIN OAAS_USER OU2 ON OU2.USER_ID = OO.MODIFY_USER_ID
		LEFT JOIN OAAS_AREA OA ON OA.AREA_ID = OO.AREA_ID
		<where>
			<if test="orgType == 'CURORG'">
				EXISTS
				(SELECT 1 FROM
					OAAS_JOB OJ 
					JOIN OAAS_STAFF_JOB OSJ ON OJ.JOB_ID = OSJ.JOB_ID
					JOIN OAAS_STAFF OS ON OSJ.STAFF_ID = OS.STAFF_ID
					JOIN OAAS_USER_STAFF OUS ON OUS.STAFF_ID = OS.STAFF_ID
					WHERE OO.ORG_ID = OJ.ORG_ID
					AND
					OUS.USER_ID =
				#{userId,jdbcType=DECIMAL})
			</if>
			<if test="orgType == 'SUBORG'">
				EXISTS
				(SELECT 1 FROM
					OAAS_JOB OJ 
					JOIN OAAS_STAFF_JOB OSJ ON OJ.JOB_ID = OSJ.JOB_ID
					JOIN OAAS_STAFF OS ON OSJ.STAFF_ID = OS.STAFF_ID
					JOIN OAAS_USER_STAFF OUS ON OUS.STAFF_ID = OS.STAFF_ID
					WHERE OO.PARENT_ORG_ID = OJ.ORG_ID AND
					OUS.USER_ID =
				#{userId,jdbcType=DECIMAL})
			</if>
			<if test="orgType == 'ALLORG'">
				<if test="parentOrgId == null or parentOrgId == '' ">
					AND  OO.PARENT_ORG_ID = -1
				</if>
			</if>
			<if test="orgType == null or orgType == ''">
				AND 1=2
			</if>
			AND OO.STATE = '10A'
			<if test="orgId != null and orgId!=''">
				AND OO.ORG_ID = #{orgId,jdbcType=DECIMAL}
			</if>
			<if test="parentOrgId != null and parentOrgId != ''">
				AND  OO.PARENT_ORG_ID = #{parentOrgId,jdbcType=DECIMAL}
			</if>
		</where>
		
		ORDER BY OO.DISPLAY_INDEX
	</select>
	
	<select id="selectSubOrgById" parameterType="java.math.BigDecimal"
		resultMap="BaseResultMap">
		SELECT OO.*
		FROM OAAS_ORG OO WHERE
		OO.PARENT_ORG_ID = #{orgId,jdbcType=DECIMAL}
	</select>
	
	
	<select id="selectSubOrgByPathId" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		SELECT OO.*,POO.ORG_CODE 'parentOrgCode' ,POO.ORG_ABS_NAME 'parentOrgAbsName',AREA.AREA_NAME 'areaName',STAFF.STAFF_NAME 'orgAdmin',STAFF.TELEPHONE 'orgAdminMobile',
	    STAFF.POST 'orgAdminPost',CU.USER_TEXT 'createUserName',MU.USER_TEXT 'modifyUserName'
	    FROM OAAS_ORG OO
	    LEFT JOIN OAAS_ORG POO ON POO.ORG_ID = OO.PARENT_ORG_ID
	    LEFT JOIN OAAS_AREA AREA ON AREA.AREA_ID = OO.AREA_ID AND AREA.STATE = '10A'
	    LEFT JOIN OAAS_ORG_COMPANY OC ON OC.ORG_ID = OO.ORG_ID
	    LEFT JOIN OAAS_COMPANY COMPANY ON COMPANY.COMPANY_ID = OC.COMPANY_ID  AND COMPANY.STATE = '10A'
	    LEFT JOIN OAAS_USER_STAFF US ON US.USER_ID = OO.ORG_ADMIN
	    LEFT JOIN OAAS_STAFF STAFF ON STAFF.STAFF_ID = US.STAFF_ID
	    LEFT JOIN OAAS_USER CU ON CU.USER_ID = OO.CREATE_USER_ID
	    LEFT JOIN OAAS_USER MU ON MU.USER_ID = OO.MODIFY_USER_ID
	    WHERE POO.STATE = '10A'  
	    AND FIND_IN_SET(#{orgId,jdbcType=VARCHAR},OO.ID_PATH) AND OO.ORG_ID != #{orgId,jdbcType=VARCHAR}
	</select>
	
	
	<select id="selectExistOrgCode" parameterType="string" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM OAAS_ORG WHERE ORG_CODE = #{orgCode,jdbcType=VARCHAR}
	</select>
	
	<update id="updateAllStateById">
		UPDATE OAAS_ORG SET STATE = '10X' WHERE FIND_IN_SET(#{orgId,jdbcType=VARCHAR},ID_PATH)>0
	</update>
	
	<select id="selectOrgByUserId" parameterType="java.lang.Long"
		resultMap="BaseResultMap">
		SELECT OO.*,OSJ.STAFF_JOB_ID
		FROM
		OAAS_ORG AS OO
		INNER JOIN OAAS_JOB AS OJ ON OJ.ORG_ID = OO.ORG_ID
		INNER JOIN OAAS_STAFF_JOB AS OSJ ON OSJ.JOB_ID = OJ.JOB_ID AND OSJ.DEFAULT_JOB = 1
		INNER JOIN OAAS_STAFF AS OS ON OS.STAFF_ID = OSJ.JOB_ID
		INNER JOIN OAAS_USER_STAFF AS OUS ON OUS.STAFF_ID = OS.STAFF_ID
		WHERE
		OJ.STATE = '10A' AND
		OO.STATE = '10A' AND
		OS.STATE = '10A' AND
		OUS.USER_ID = #{userId,jdbcType=DECIMAL}
	</select>
<select id="selectByParentOrgId" parameterType="java.math.BigDecimal" resultMap="BaseResultMap">
    SELECT 
    <include refid="Base_Column_List" />
    FROM OAAS_ORG
    WHERE STATE = '10A' 
	 <![CDATA[
	AND INSTR(ID_PATH,#{parentOrgId,jdbcType=DECIMAL}) > 0
	]]>
  </select>
  
  <select id="selectOrgByOrg" parameterType="com.basic.oaas.model.Org" resultMap="BaseResultMap">
    SELECT 
    <include refid="Base_Column_List" />
    FROM OAAS_ORG
   <where>
   		STATE = '10A'
  	 <if test="state != null">
      AND STATE = #{state,jdbcType=VARCHAR}
      </if>
   	<if test="orgCode != null">
      AND ORG_CODE = #{orgCode,jdbcType=VARCHAR}
      </if>
     <if test="parentOrgId != null">
      AND PARENT_ORG_ID = #{parentOrgId,jdbcType=DECIMAL}
      </if>
   </where>
  </select>
  
   <select id="qryOrgStaffCount" resultType="java.lang.Integer" parameterType="java.lang.String">
	 SELECT COUNT(0) FROM OAAS_STAFF S
		LEFT JOIN OAAS_STAFF_JOB SJ ON  S.STAFF_ID = SJ.STAFF_ID
	LEFT JOIN  OAAS_JOB JOB  ON JOB.JOB_ID = SJ.JOB_ID 
			LEFT JOIN OAAS_ORG ORG  ON ORG.ORG_ID=JOB.ORG_ID
	<where>
	S.STATE = '10A'
	AND ORG.STATE = '10A'
	AND ORG.ORG_CODE = #{orgCode,jdbcType=VARCHAR}
	 </where>
  </select>
  
    <select id="selectOrgByOrgCode" parameterType="java.lang.String" resultMap="BaseResultMap">
    SELECT 
    <include refid="Base_Column_List" />
    FROM OAAS_ORG
   <where>
   		STATE = '10A'
   		AND ORG_CODE = #{orgCode,jdbcType=VARCHAR}
   </where>
  </select>
  
   <select id="query" parameterType="java.util.Map" resultMap="BaseResultMap">
	SELECT ORG.*,
	(CASE (SELECT COUNT(1) FROM OAAS_ORG WHERE PARENT_ORG_ID = ORG.ORG_ID) WHEN 0 THEN FALSE ELSE TRUE END) 'isParent'
	FROM OAAS_ORG ORG
	
	<where>
	    ORG.state = '10A'
	    <if test="whereSql!=null">
	        AND ${whereSql}
	    </if>
	</where>
	<if test="orderBySql!=null">
	    ORDER BY ${orderBySql}
	</if>
	<if test="orderBySql==null">
	    ORDER BY ORG.DISPLAY_INDEX ASC
	</if>
	
	
  </select>
  
  
  	<select id="selectFindInSet" parameterType="java.util.Map" resultMap="BaseResultMap">
		SELECT *
		FROM OAAS_ORG WHERE STATE = '10A' AND 
		FIND_IN_SET(${value},${column})>0
	</select>
	
  	<select id="checkByOrgCode" parameterType="java.lang.String" resultMap="BaseResultMap">
		SELECT * FROM OAAS_ORG WHERE ORG_CODE = #{orgCode}
	</select>
	
	<select id="countOrg" parameterType="java.util.Map" resultType="java.lang.Integer">
		SELECT COUNT(1) FROM OAAS_ORG 
		WHERE 1=1
		<if test="parentId!=null">
			AND PARENT_ORG_ID = #{parentId}
		</if>
		<if test="source!=null">
			AND SOURCE = #{source}
		</if>
		<if test="code!=null">
			AND ORG_CODE = #{code}
		</if>
	</select>
</mapper>